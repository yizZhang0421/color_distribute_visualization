chart = [[(255, 255, 255),
          (223, 223, 240),
          (221, 223, 241),
          (219, 223, 242),
          (216, 223, 243),
          (213, 223, 244),
          (208, 223, 244),
          (204, 224, 244),
          (200, 225, 242),
          (170, 225, 249),
          (140, 227, 248),
          (138, 230, 242),
          (138, 231, 236),
          (140, 234, 227),
          (170, 234, 221),
          (201, 232, 217),
          (206, 233, 211),
          (212, 234, 206),
          (216, 234, 204),
          (219, 234, 202),
          (222, 234, 201),
          (224, 234, 200),
          (227, 234, 200),
          (230, 234, 201),
          (233, 233, 202),
          (235, 232, 205),
          (236, 231, 208),
          (237, 230, 211),
          (237, 229, 214),
          (237, 228, 218),
          (237, 228, 220),
          (237, 227, 224),
          (236, 226, 227),
          (236, 225, 228),
          (235, 225, 230),
          (232, 224, 233),
          (231, 224, 235),
          (229, 224, 236),
          (227, 223, 237),
          (226, 223, 239),
          (224, 223, 239)],
         [(219, 219, 219),
          (183, 183, 250),
          (177, 183, 252),
          (169, 183, 253),
          (160, 184, 253),
          (151, 185, 251),
          (143, 188, 247),
          (112, 187, 254),
          (67, 188, 255),
          (0, 192, 248),
          (0, 199, 233),
          (0, 202, 222),
          (0, 206, 212),
          (0, 210, 196),
          (67, 213, 181),
          (92, 218, 155),
          (135, 218, 145),
          (154, 220, 123),
          (176, 217, 134),
          (183, 217, 129),
          (190, 217, 125),
          (195, 217, 122),
          (202, 212, 150),
          (207, 211, 150),
          (212, 211, 150),
          (216, 210, 151),
          (221, 208, 156),
          (223, 207, 162),
          (225, 205, 169),
          (242, 205, 160),
          (244, 202, 171),
          (226, 199, 192),
          (225, 197, 198),
          (223, 196, 204),
          (221, 195, 208),
          (224, 188, 225),
          (218, 186, 232),
          (211, 185, 238),
          (202, 184, 243),
          (196, 183, 246),
          (189, 183, 248)],
         [(182, 182, 182),
          (152, 149, 237),
          (144, 149, 239),
          (123, 143, 253),
          (107, 145, 251),
          (94, 149, 247),
          (22, 147, 255),
          (0, 154, 242),
          (0, 161, 229),
          (0, 167, 217),
          (0, 172, 204),
          (0, 175, 193),
          (0, 179, 184),
          (0, 183, 170),
          (0, 187, 152),
          (70, 191, 128),
          (95, 194, 102),
          (121, 196, 66),
          (146, 193, 82),
          (154, 194, 73),
          (162, 194, 64),
          (170, 194, 53),
          (180, 193, 41),
          (185, 188, 94),
          (192, 188, 94),
          (199, 187, 96),
          (205, 185, 103),
          (209, 183, 113),
          (226, 183, 98),
          (228, 179, 119),
          (230, 176, 135),
          (214, 172, 161),
          (212, 169, 172),
          (209, 166, 181),
          (205, 164, 188),
          (207, 157, 207),
          (199, 154, 215),
          (194, 146, 234),
          (180, 144, 241),
          (170, 150, 232),
          (160, 150, 235)],
         [(146, 146, 146),
          (118, 106, 235),
          (105, 106, 236),
          (88, 108, 236),
          (47, 104, 244),
          (0, 111, 236),
          (21, 123, 219),
          (0, 130, 208),
          (0, 136, 197),
          (0, 141, 186),
          (0, 145, 175),
          (0, 149, 165),
          (0, 152, 156),
          (0, 156, 143),
          (0, 160, 127),
          (0, 166, 91),
          (52, 170, 45),
          (99, 169, 20),
          (119, 168, 0),
          (129, 168, 0),
          (138, 167, 0),
          (146, 166, 0),
          (156, 165, 0),
          (164, 164, 0),
          (172, 163, 0),
          (180, 162, 0),
          (191, 161, 0),
          (196, 159, 45),
          (213, 158, 1),
          (216, 154, 68),
          (216, 150, 95),
          (201, 144, 132),
          (198, 140, 146),
          (195, 137, 159),
          (189, 134, 168),
          (190, 125, 188),
          (180, 122, 197),
          (169, 120, 204),
          (155, 118, 212),
          (144, 107, 229),
          (131, 106, 232)],
         [(109, 109, 109),
          (92, 63, 218),
          (74, 65, 219),
          (53, 68, 218),
          (0, 72, 216),
          (0, 90, 198),
          (0, 99, 185),
          (0, 106, 174),
          (0, 111, 164),
          (13, 116, 154),
          (0, 119, 146),
          (0, 123, 137),
          (0, 125, 129),
          (0, 128, 118),
          (22, 132, 104),
          (10, 137, 73),
          (32, 142, 0),
          (82, 140, 0),
          (98, 139, 0),
          (107, 138, 0),
          (114, 138, 0),
          (121, 137, 0),
          (130, 136, 0),
          (136, 136, 0),
          (144, 135, 0),
          (151, 134, 0),
          (159, 133, 0),
          (168, 132, 0),
          (178, 130, 0),
          (193, 127, 0),
          (204, 124, 37),
          (188, 117, 101),
          (184, 111, 123),
          (179, 107, 138),
          (173, 103, 149),
          (164, 99, 161),
          (162, 87, 179),
          (150, 83, 188),
          (133, 79, 197),
          (121, 65, 212),
          (106, 64, 215)],
         [(73, 73, 73),
          (71, 21, 188),
          (51, 26, 188),
          (32, 33, 186),
          (0, 50, 178),
          (15, 70, 158),
          (27, 79, 145),
          (13, 83, 139),
          (32, 89, 127),
          (26, 92, 121),
          (20, 94, 115),
          (17, 97, 109),
          (17, 99, 102),
          (23, 101, 93),
          (32, 104, 83),
          (19, 109, 57),
          (41, 111, 33),
          (66, 111, 0),
          (78, 110, 0),
          (85, 110, 0),
          (91, 109, 0),
          (97, 109, 0),
          (104, 108, 0),
          (110, 107, 0),
          (115, 107, 0),
          (121, 106, 0),
          (128, 105, 0),
          (135, 104, 0),
          (143, 103, 0),
          (155, 101, 0),
          (163, 97, 32),
          (175, 89, 71),
          (158, 84, 99),
          (152, 80, 114),
          (146, 76, 124),
          (138, 72, 134),
          (130, 68, 143),
          (120, 65, 150),
          (108, 62, 157),
          (97, 60, 161),
          (87, 59, 164)],
         [(36, 36, 36),
          (55, 22, 139),
          (43, 24, 139),
          (22, 0, 148),
          (16, 34, 136),
          (14, 50, 121),
          (24, 59, 109),
          (17, 62, 104),
          (8, 65, 99),
          (31, 69, 89),
          (29, 70, 84),
          (28, 72, 80),
          (29, 73, 75),
          (31, 75, 69),
          (36, 76, 63),
          (26, 80, 45),
          (38, 82, 31),
          (50, 83, 0),
          (58, 83, 0),
          (63, 82, 0),
          (68, 82, 0),
          (73, 81, 0),
          (79, 81, 0),
          (83, 80, 0),
          (88, 80, 0),
          (92, 79, 0),
          (97, 78, 0),
          (103, 78, 0),
          (109, 77, 0),
          (119, 75, 0),
          (132, 72, 0),
          (149, 61, 50),
          (134, 57, 78),
          (127, 52, 93),
          (122, 47, 102),
          (115, 43, 110),
          (109, 38, 117),
          (98, 33, 125),
          (87, 29, 130),
          (77, 26, 134),
          (66, 23, 137)],
         [(0, 0, 0),
          (46, 14, 97),
          (37, 14, 98),
          (28, 16, 98),
          (26, 30, 87),
          (29, 38, 76),
          (23, 40, 74),
          (17, 42, 71),
          (33, 46, 60),
          (32, 47, 58),
          (31, 48, 55),
          (32, 49, 53),
          (33, 50, 51),
          (35, 50, 48),
          (37, 51, 46),
          (26, 54, 33),
          (32, 55, 27),
          (37, 55, 21),
          (39, 57, 0),
          (43, 57, 0),
          (47, 56, 0),
          (50, 56, 3),
          (55, 55, 0),
          (58, 55, 0),
          (62, 55, 0),
          (65, 54, 0),
          (68, 54, 0),
          (73, 53, 0),
          (77, 52, 0),
          (85, 51, 0),
          (95, 49, 0),
          (111, 39, 36),
          (95, 38, 55),
          (90, 34, 65),
          (86, 31, 72),
          (73, 36, 70),
          (70, 34, 73),
          (71, 22, 86),
          (65, 19, 90),
          (59, 18, 92),
          (53, 16, 94)]]

search_dict=dict()
for i in range(len(chart)):
    for j in range(len(chart[i])):
        chart[i][j]
        key=(((chart[i][j][0]<<8)+chart[i][j][1])<<8)+chart[i][j][2]
        value=(i, j)
        search_dict[key]=value

import numpy as np
chart=np.array(chart)
from scipy.spatial import KDTree
x=np.ravel(chart[:,:,0])
y=np.ravel(chart[:,:,1])
z=np.ravel(chart[:,:,2])
tree = KDTree(list(zip(x, y, z)))

import cv2
img=cv2.imread('colorful.jfif')
limit=100
if max(img.shape[0], img.shape[1])>limit:
    if img.shape[0]>=img.shape[1]:
        h=limit
        w=int(round(img.shape[1]*limit/img.shape[0]))
    else:
        w=limit
        h=int(round(img.shape[0]*limit/img.shape[1]))
    img = cv2.resize(img, (w, h), interpolation=cv2.INTER_CUBIC)

table=np.zeros([len(chart), len(chart[0])], dtype=np.int64)
for r in img:
    for c in r:
        distance, index=tree.query(c)
        searchered=tree.data[index]
        nearest_i, nearest_j=search_dict[(((searchered[0]<<8)+searchered[1])<<8)+searchered[2]]
        table[nearest_i][nearest_j]+=1

html=open('html_show/demos/barchart_template.html', 'r').read()
for i in range(len(table)):
    tmp='['
    for j in table[i]:
        tmp+=str(j)+','
    tmp=tmp[:-1]+']'
    html=html.replace('VALUE_LIST_'+str(i), tmp)
open('html_show/demos/barchart.html', 'w').write(html)

import webbrowser, os
webbrowser.open('file:\\\\\\'+os.getcwd()+'\\html_show\\demos\\barchart.html')
